@model ASP.NET_MVC_MajsterStrelby.Models.GameWordsModel
@{
    ViewBag.Title = "Game";
}

<div class="jumbotron">
    <h2 id="taskWord" class="text-center">@Model.GetTaskWord()</h2>
    <h4 class="text-center">3:25</h4>
</div>

@using (Html.BeginForm("SendData", "Game", FormMethod.Post))
{
    <ul>
        @foreach (var possibleWord in Model.GetPossibleWords())
        {
            <li>
                <button type="button" class="btn btn-primary btn-lg" onclick="return onClickDisabled.call(this);" value=@possibleWord>@possibleWord</button>
            </li>
        }

        <button type="button" class="btn btn-primary btn-lg" onclick="return sendData()" value=@Model.GetTaskWord() >"Odoslať odpoveď"</button>

    </ul>

    <script>
        //var taskword = document.getElementById('taskWord');
        var words = [];
        var model = @Html.Raw(Json.Encode(Model));
        var counter = 0;
        
        function onClickDisabled() {
            this.disabled = 'true';
            console.log(this);
            console.log(words);
            words[counter++] = this.value;
            return true;
        }

        function sendData() {
            $.ajax({
                contentType: 'application/json',
                dataType: 'json',
                type: 'POST',
                url: "@Url.Action("SendData","Game")",
                data: JSON.stringify({
                    choosenWords: words,
                    model: model
                }),
                success: function (response) {
                    alert(response.Success);
                    alert(response.Message);
                    console.log(response);
                    window.location.href = '@Url.Action("ShowPoints", "Game")';
                },
                failure: function (response) {
                    alert(response.Success);
                    alert(response.Message);
                    console.log(response);
                }
            });

            return true;
        }

    </script>
}

